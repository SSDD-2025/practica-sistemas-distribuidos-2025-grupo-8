<!DOCTYPE html>
<html>
<head>
    <title>Mostrar Maquinarias</title>
    <link rel="stylesheet" type="text/css" href="/style.css">
</head>
<body>
    {{>common/header}}

    <h1>Maquinarias de Golden Gym</h1>

    <div id="machinery-list"></div>

    <div id="pagination-buttons">
        <button onclick="loadMachineries(0)">Página 1</button>
        <button onclick="loadMachineries(1)">Página 2</button>
    </div>

    <form action="/account" method="post">
        <input type="submit" value="Volver">
        <input type="hidden" name="_csrf" value="{{token}}"/>
    </form>

    <script>
        function loadMachineries(page) {
            fetch(`/api/machineries?page=${page}&size=5`) 
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    let html = "";
                    data.content.forEach(machine => {
                        html += `
                            <div class="inRows">
                                <ul>
                                    <li>
                                        <div class="alignItems">
                                            <form action="/machinery/${machine.id}" method="get">
                                                <button type="submit" class="button">${machine.name}</button>
                                            </form>
                                            ${machine.isAdmin ? `
                                            <form action="/machinery/delete/${machine.id}" method="post">
                                                <input type="submit" value="Borrar maquinaria">
                                                <input type="hidden" name="_csrf" value="${machine.token}"/>
                                            </form>
                                            ` : ''}
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        `;
                    });
                    document.getElementById("machinery-list").innerHTML = html;
                })
                .catch(error => {
                    console.error('Error cargando maquinarias:', error);
                });
        }

        loadMachineries(0);
    </script>
</body>
</html>
